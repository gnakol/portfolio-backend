spring:
  datasource:
    url: jdbc:mysql://mysql:3306/portfolio_db
    username: kol_sec_admin
    password: noumko009
  jpa:
    hibernate:
      ddl-auto: none

  mail:
    host: smtp.mail.yahoo.com
    port: 587
    username: gna.kolie@yahoo.fr
    password: ${YAHOO_APP_PASSWORD}
    properties:
      mail.smtp.auth: true
      mail.smtp.starttls.enable: true

  task:
    scheduling:
      enabled: true

  # ✅ NOUVEAU: Limites multipart côté Spring (copié du local)
  servlet:
    multipart:
      enabled: true
      max-file-size: 500MB          # taille max d'un fichier
      max-request-size: 500MB       # taille max de la requête

  mvc:
    async:
      request-timeout: 10m          # évite les timeouts lors d'uploads lourds

server:
  port: 9000
  servlet:
    context-path: /portfolio-api
  # ✅ NOUVEAU: Configuration Tomcat pour gros fichiers (copié du local)
  tomcat:
    max-swallow-size: -1            # 
    max-http-post-size: 524288000   # 500MB (524288000 bytes) - CRITIQUE pour les uploads
    connection-timeout: 60s

management:
  endpoints:
    web:
      base-path: /actuator
      exposure:
        include: health,info,prometheus,metrics,env,configprops
  endpoint:
    health:
      show-details: always
      probes:
        enabled: true
    prometheus:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true

security:
  tls:
    hosts: kolie-portfolio.org:443, v2.kolie-portfolio.org:443

backup:
  scheduled: true
  dir: /tmp
  retentionDays: 7

monitoring:
  retention:
    availability:
      detailed-hours: 12
      aggregated-days: 7
    security:
      detailed-days: 1
      aggregated-days: 30
    backup:
      logs-days: 30

cloud:
  aws:
    credentials:
      accessKey: ${AWS_ACCESS_KEY}
      secretKey: ${AWS_SECRET_KEY}
    region:
      static: eu-north-1
    stack:
      auto: false
    # ✅ NOUVEAU: Configuration S3 spécifique (copié du local)
    s3:
      bucket: ${AWS_S3_BUCKET:kolie-portfolio-profile}
      mediaFolder: media/

# Configuration Prometheus (service interne K8s)
prometheus:
  url: ${PROMETHEUS_URL:http://kps-kube-prometheus-stack-prometheus.monitoring.svc.cluster.local:9090}

# Configuration personnalisée pour le nettoyage des tokens
token:
  cleanup:
    enabled: true
    schedule: "0 0 3 * * ?"
    retention-days: 1